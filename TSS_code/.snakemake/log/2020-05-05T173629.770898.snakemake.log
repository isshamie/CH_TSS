Building DAG of jobs...
Using shell: /bin/bash
Provided cores: 1
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	2	barplot
	2	create_output
	2	gene_centric_tss
	2	merge_peaks
	2	peak_expression_and_location
	2	process_genome
	2	retrieve_peaks
	15

[Tue May  5 17:36:30 2020]
rule process_genome:
    input: /data/isshamie/genome/hamster/ncbi_anno_103/GCF_003668045.1_CriGri-PICR/GCF_003668045.1_CriGri-PICR_genomic.gff, /data/isshamie/genome/ncbi_anno_103/GCF_003668045.1_CriGri-PICR_genomic.fna
    output: data/processed/GCF/genome/mRNA.peak, data/processed/GCF/genome/start_site_mRNA.tsv
    jobid: 7
    wildcards: anno=GCF

python tss/data/generate_genome.py /data/isshamie/genome/ncbi_anno_103/GCF_003668045.1_CriGri-PICR_genomic.fna /data/isshamie/genome/hamster/ncbi_anno_103/GCF_003668045.1_CriGri-PICR/GCF_003668045.1_CriGri-PICR_genomic.gff data/processed/GCF/genome/mRNA.peak
[Tue May  5 17:53:28 2020]
Finished job 7.
1 of 15 steps (7%) done

[Tue May  5 17:53:28 2020]
rule process_genome:
    input: /data/isshamie/genome/hamster/ncbi_anno_103/alt_CriGri-PICR_top_level.gff3, /data/isshamie/genome/ncbi_anno_103/GCF_003668045.1_CriGri-PICR_genomic.fna
    output: data/processed/alt/genome/mRNA.peak, data/processed/alt/genome/start_site_mRNA.tsv
    jobid: 10
    wildcards: anno=alt

python tss/data/generate_genome.py /data/isshamie/genome/ncbi_anno_103/GCF_003668045.1_CriGri-PICR_genomic.fna /data/isshamie/genome/hamster/ncbi_anno_103/alt_CriGri-PICR_top_level.gff3 data/processed/alt/genome/mRNA.peak
[Tue May  5 18:10:03 2020]
Finished job 10.
2 of 15 steps (13%) done

[Tue May  5 18:10:03 2020]
rule merge_peaks:
    input: data/processed/GCF/genome/start_site_mRNA.tsv, /data/isshamie/genome/hamster/ncbi_anno_103/GCF_003668045.1_CriGri-PICR/GCF_003668045.1_CriGri-PICR_genomic.gff
    output: data/processed/GCF/merged/samples.merge
    log: data/processed/GCF/merged/merged.log
    jobid: 11
    wildcards: anno=GCF

python tss/data/merging.py data/processed/GCF/genome/start_site_mRNA.tsv /data/isshamie/genome/hamster/ncbi_anno_103/GCF_003668045.1_CriGri-PICR/GCF_003668045.1_CriGri-PICR_genomic.gff data/processed/GCF/merged/samples.merge /data/isshamie/TSS/Analysis/Analysis_NCBI_PICR/f04_peaks/ /data/isshamie/genome/ncbi_anno_103/GCF_003668045.1_CriGri-PICR_genomic.fna to_merge &> data/processed/GCF/merged/merged.log
[Tue May  5 18:17:01 2020]
Finished job 11.
3 of 15 steps (20%) done

[Tue May  5 18:17:01 2020]
rule peak_expression_and_location:
    input: data/processed/GCF/genome/start_site_mRNA.tsv, /data/isshamie/genome/hamster/ncbi_anno_103/GCF_003668045.1_CriGri-PICR/GCF_003668045.1_CriGri-PICR_genomic.gff, data/processed/GCF/merged/samples.merge
    output: data/processed/GCF/merged/peaks_with_tss_distances_size1.noCDS.peak, data/processed/GCF/merged/files_used.json, data/processed/GCF/merged/samples.merge.peaksexpression.log2
    log: data/processed/GCF/merged/anno_and_exp.log
    jobid: 12
    wildcards: anno=GCF

python tss/data/merging.py data/processed/GCF/genome/start_site_mRNA.tsv /data/isshamie/genome/hamster/ncbi_anno_103/GCF_003668045.1_CriGri-PICR/GCF_003668045.1_CriGri-PICR_genomic.gff data/processed/GCF/merged/peaks_with_tss_distances_size1.noCDS.peak /data/isshamie/TSS/Analysis/Analysis_NCBI_PICR/f04_peaks/ /data/isshamie/genome/ncbi_anno_103/GCF_003668045.1_CriGri-PICR_genomic.fna to_anno_and_exp &> data/processed/GCF/merged/anno_and_exp.log
Warning: the following output files of rule peak_expression_and_location were not present when the DAG was created:
{'data/processed/GCF/merged/files_used.json'}
[Tue May  5 18:21:08 2020]
Finished job 12.
4 of 15 steps (27%) done

[Tue May  5 18:21:08 2020]
rule merge_peaks:
    input: data/processed/alt/genome/start_site_mRNA.tsv, /data/isshamie/genome/hamster/ncbi_anno_103/alt_CriGri-PICR_top_level.gff3
    output: data/processed/alt/merged/samples.merge
    log: data/processed/alt/merged/merged.log
    jobid: 13
    wildcards: anno=alt

python tss/data/merging.py data/processed/alt/genome/start_site_mRNA.tsv /data/isshamie/genome/hamster/ncbi_anno_103/alt_CriGri-PICR_top_level.gff3 data/processed/alt/merged/samples.merge /data/isshamie/TSS/Analysis/Analysis_NCBI_PICR/f04_peaks/ /data/isshamie/genome/ncbi_anno_103/GCF_003668045.1_CriGri-PICR_genomic.fna to_merge &> data/processed/alt/merged/merged.log
[Tue May  5 18:28:00 2020]
Finished job 13.
5 of 15 steps (33%) done

[Tue May  5 18:28:00 2020]
rule peak_expression_and_location:
    input: data/processed/alt/genome/start_site_mRNA.tsv, /data/isshamie/genome/hamster/ncbi_anno_103/alt_CriGri-PICR_top_level.gff3, data/processed/alt/merged/samples.merge
    output: data/processed/alt/merged/peaks_with_tss_distances_size1.noCDS.peak, data/processed/alt/merged/files_used.json, data/processed/alt/merged/samples.merge.peaksexpression.log2
    log: data/processed/alt/merged/anno_and_exp.log
    jobid: 14
    wildcards: anno=alt

python tss/data/merging.py data/processed/alt/genome/start_site_mRNA.tsv /data/isshamie/genome/hamster/ncbi_anno_103/alt_CriGri-PICR_top_level.gff3 data/processed/alt/merged/peaks_with_tss_distances_size1.noCDS.peak /data/isshamie/TSS/Analysis/Analysis_NCBI_PICR/f04_peaks/ /data/isshamie/genome/ncbi_anno_103/GCF_003668045.1_CriGri-PICR_genomic.fna to_anno_and_exp &> data/processed/alt/merged/anno_and_exp.log
Warning: the following output files of rule peak_expression_and_location were not present when the DAG was created:
{'data/processed/alt/merged/files_used.json'}
[Tue May  5 18:32:02 2020]
Finished job 14.
6 of 15 steps (40%) done

[Tue May  5 18:32:02 2020]
rule gene_centric_tss:
    input: data/processed/GCF/merged/files_used.json, data/processed/GCF/genome/start_site_mRNA.tsv, /data/isshamie/TSS/Analysis/Analysis_03302020/parameters/samples.tsv
    output: data/processed/GCF/gene_centric_tss/txn_df.p, data/processed/GCF/gene_centric_tss/files_used.json
    log: data/processed/GCF/gene_centric_tss/gene_centric.log
    jobid: 6
    wildcards: anno=GCF

python tss/data/gene_centric.py data/processed/GCF/gene_centric_tss/txn_df.p data/processed/GCF/merged/files_used.json data/processed/GCF/genome/start_site_mRNA.tsv /data/isshamie/TSS/Analysis/Analysis_03302020/parameters/samples.tsv False -1000 1000 &> data/processed/GCF/gene_centric_tss/gene_centric.log
[Tue May  5 18:32:04 2020]
Error in rule gene_centric_tss:
    jobid: 6
    output: data/processed/GCF/gene_centric_tss/txn_df.p, data/processed/GCF/gene_centric_tss/files_used.json
    log: data/processed/GCF/gene_centric_tss/gene_centric.log (check log file(s) for error message)
    shell:
        python tss/data/gene_centric.py data/processed/GCF/gene_centric_tss/txn_df.p data/processed/GCF/merged/files_used.json data/processed/GCF/genome/start_site_mRNA.tsv /data/isshamie/TSS/Analysis/Analysis_03302020/parameters/samples.tsv False -1000 1000 &> data/processed/GCF/gene_centric_tss/gene_centric.log
        (exited with non-zero exit code)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /data/isshamie/TSS/Analysis/TSS_code/.snakemake/log/2020-05-05T173629.770898.snakemake.log
